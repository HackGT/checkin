var app=angular.module("checkin",["ui.router","infinite-scroll"]);app.config(["$httpProvider",function(e,t){e.interceptors.push("ApiAuthenticator")}]),app.factory("ApiAuthenticator",["Session","SERVER_URL",function(e,t){return{request:function(n){0!==n.url.indexOf("api/")&&0!==n.url.indexOf("auth/")||(n.url=t.BASE_URL+n.url,n.headers["Access-Control-Allow-Origin"]=t.BASE_URL);var o=e.getToken();return o&&(n.headers["x-access-token"]=o),n}}}]),angular.module("checkin").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:"views/login/login.html",controller:"LoginController"}).state("checkin",{url:"/checkin",templateUrl:"views/checkin/checkin.html",controller:"CheckinController"})}]),angular.module("checkin").factory("AuthService",["$q","$http","$rootScope","$state","Session",function(e,t,n,o,r){function c(t){var n=t.data;return console.log("auth success",n),r.create(n.token,n.user),e(function(e){e(n.user)})}function i(t,n){return console.log("auth fail",t),o.go("login"),e(function(e,n){n(t)})}var s={},u="auth/";return s.loginWithPassword=function(e,n){return t.post(u+"login",{email:e,password:n}).then(c,i)},s.loginWithToken=function(e){return console.warn("Not actually sure if this works yet!"),t.post(u+"login",{token:e}).then(c,function(){400===status&&r.destroy().then(i)})},s}]),angular.module("checkin").service("Session",["$rootScope","$window","$q",function(e,t,n){this.create=function(n,o){t.localStorage.jwt=n,t.localStorage.userId=o._id,t.localStorage.currentUser=JSON.stringify(o),e.currentUser=o},this.destroy=function(){return delete t.localStorage.jwt,delete t.localStorage.userId,delete t.localStorage.currentUser,e.currentUser=null,n(function(e,t){e()})},this.getToken=function(){return t.localStorage.jwt},this.getUserId=function(){return t.localStorage.userId},this.getUser=function(){return JSON.parse(t.localStorage.currentUser)}}]),angular.module("checkin").factory("UserService",["$q","$http","Session",function(e,t,n){var o="api/users",r=o+"/",c={};return c.getUsers=function(e){var n=e?o+"?"+$.param({text:e.text,page:e.page?e.page:0,size:e.size?e.size:50}):r;return t.get(n)},c.checkin=function(e){return t.post(r+e+"/checkin")},c.checkout=function(e){return t.post(r+e+"/checkout")},c}]),angular.module("checkin").controller("CheckinController",["$scope","UserService",function(e,t){e.users={users:[],busy:!1,nextPage:0,totalPages:1/0},e.users.getNextPage=function(){this.busy||this.nextPage>=this.totalPages||(this.busy=!0,t.getUsers({page:this.nextPage}).then(function(e){console.log(e.data),this.users=this.users.concat(e.data.users),this.totalPages=e.data.totalPages,this.nextPage+=1,this.busy=!1}.bind(this)))},e.checkin=function(e){t.checkin(e).then(function(e){console.log("checked in",e)})},e.checkout=function(e){t.checkout(e).then(function(e){console.log("checked out",e)})}}]),angular.module("checkin").controller("LoginController",["$scope","AuthService",function(e,t){function n(e){console.log("success",e)}function o(e){console.log("failure",e)}e.login=function(){t.loginWithPassword(e.email,e.password).then(n,o)}}]),angular.module("checkin").constant("SERVER_URL",{BASE_URL:"https://apply.hackgt.com/"});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInJvdXRlcy5qcyIsImF1dGgvQXV0aFNlcnZpY2UuanMiLCJzZXNzaW9uL1Nlc3Npb24uanMiLCJ1c2Vycy9Vc2VyU2VydmljZS5qcyIsImNoZWNraW4vY2hlY2tpbkNvbnRyb2xsZXIuanMiLCJsb2dpbi9sb2dpbkNvbnRyb2xsZXIuanMiLCJjb25maWcuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRodHRwUHJvdmlkZXIiLCJTRVJWRVJfVVJMIiwiaW50ZXJjZXB0b3JzIiwicHVzaCIsImZhY3RvcnkiLCJTZXNzaW9uIiwicmVxdWVzdCIsInVybCIsImluZGV4T2YiLCJCQVNFX1VSTCIsImhlYWRlcnMiLCJ0b2tlbiIsImdldFRva2VuIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIiRxIiwiJGh0dHAiLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwibG9naW5TdWNjZXNzIiwicmVzcG9uc2UiLCJkYXRhIiwiY29uc29sZSIsImxvZyIsImNyZWF0ZSIsInVzZXIiLCJyZXNvbHZlIiwibG9naW5GYWlsdXJlIiwiY2FsbGJhY2siLCJnbyIsInJlamVjdCIsImF1dGhTZXJ2aWNlIiwiYmFzZVVybCIsImxvZ2luV2l0aFBhc3N3b3JkIiwiZW1haWwiLCJwYXNzd29yZCIsInBvc3QiLCJ0aGVuIiwibG9naW5XaXRoVG9rZW4iLCJ3YXJuIiwic3RhdHVzIiwiZGVzdHJveSIsInNlcnZpY2UiLCIkd2luZG93IiwidGhpcyIsImxvY2FsU3RvcmFnZSIsImp3dCIsInVzZXJJZCIsIl9pZCIsImN1cnJlbnRVc2VyIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFVzZXJJZCIsImdldFVzZXIiLCJwYXJzZSIsInVzZXJzIiwiYmFzZSIsIlVzZXJTZXJ2aWNlIiwiZ2V0VXNlcnMiLCJvcHRpb25zIiwiJCIsInBhcmFtIiwidGV4dCIsInBhZ2UiLCJzaXplIiwiZ2V0IiwiY2hlY2tpbiIsImNoZWNrb3V0IiwiJHNjb3BlIiwiYnVzeSIsIm5leHRQYWdlIiwidG90YWxQYWdlcyIsIkluZmluaXR5IiwiZ2V0TmV4dFBhZ2UiLCJjb25jYXQiLCJiaW5kIiwiQXV0aFNlcnZpY2UiLCJvblN1Y2Nlc3MiLCJvbkZhaWx1cmUiLCJsb2dpbiIsImNvbnN0YW50Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLFdBQ0EsWUFDQSxtQkFHQUYsS0FBQUcsUUFDQSxnQkFDQSxTQUFBQyxFQUFBQyxHQUdBRCxFQUFBRSxhQUFBQyxLQUFBLHVCQUlBUCxJQUFBUSxRQUFBLG9CQUNBLFVBQ0EsYUFDQSxTQUFBQyxFQUFBSixHQUNBLE9BQ0FLLFFBQUEsU0FBQVAsR0FDQSxJQUFBQSxFQUFBUSxJQUFBQyxRQUFBLFNBQUEsSUFBQVQsRUFBQVEsSUFBQUMsUUFBQSxXQUNBVCxFQUFBUSxJQUFBTixFQUFBUSxTQUFBVixFQUFBUSxJQUNBUixFQUFBVyxRQUFBLCtCQUFBVCxFQUFBUSxTQUVBLElBQUFFLEdBQUFOLEVBQUFPLFVBSUEsT0FIQUQsS0FDQVosRUFBQVcsUUFBQSxrQkFBQUMsR0FFQVosT0M1QkFGLFFBQUFDLE9BQUEsV0FDQUMsUUFDQSxpQkFDQSxxQkFDQSxTQUNBYyxFQUNBQyxHQUNBRCxFQUNBRSxNQUFBLFNBQ0FSLElBQUEsU0FDQVMsWUFBQSx5QkFDQUMsV0FBQSxvQkFFQUYsTUFBQSxXQUNBUixJQUFBLFdBQ0FTLFlBQUEsNkJBQ0FDLFdBQUEseUJDaEJBcEIsUUFBQUMsT0FBQSxXQUNBTSxRQUFBLGVBQ0EsS0FDQSxRQUNBLGFBQ0EsU0FDQSxVQUNBLFNBQUFjLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFoQixHQUlBLFFBQUFpQixHQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUFDLElBR0EsT0FGQUMsU0FBQUMsSUFBQSxlQUFBRixHQUNBbkIsRUFBQXNCLE9BQUFILEVBQUFiLE1BQUFhLEVBQUFJLE1BQ0FWLEVB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R0FDQUMsUUFBQUMsSUFBQSxhQUFBRixNQUlBK0MsRUFBQUQsU0FBQSxTQUFBcEIsR0FDQVUsRUFBQVUsU0FBQXBCLEdBQ0FWLEtBQUEsU0FBQWhCLEdBQ0FDLFFBQUFDLElBQUEsY0FBQUYsU0MzQ0EzQixRQUFBQyxPQUFBLFdBQ0FtQixXQUFBLG1CQUNBLFNBQ0EsY0FDQSxTQUFBc0QsRUFBQVEsR0FFQSxRQUFBQyxHQUFBeEQsR0FDQUMsUUFBQUMsSUFBQSxVQUFBRixHQUdBLFFBQUF5RCxHQUFBekQsR0FDQUMsUUFBQUMsSUFBQSxVQUFBRixHQUdBK0MsRUFBQVcsTUFBQSxXQUNBSCxFQUFBM0Msa0JBQ0FtQyxFQUFBbEMsTUFBQWtDLEVBQUFqQyxVQUNBRSxLQUFBd0MsRUFBQUMsT0NkQXBGLFFBQUFDLE9BQUEsV0FBQXFGLFNBQUEsY0FFQTFFLFNBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnY2hlY2tpbicsIFtcbiAgJ3VpLnJvdXRlcicsXG4gICdpbmZpbml0ZS1zY3JvbGwnLFxuXSk7XG5cbmFwcC5jb25maWcoW1xuICAnJGh0dHBQcm92aWRlcicsXG4gIGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIsIFNFUlZFUl9VUkwpIHtcblxuICAgIC8vIGFkZCByb290IHVybCB0byBhbGwgYXBpIGFuZCBhdXRoIHJlcXVlc3RzXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXBpQXV0aGVudGljYXRvcicpO1xuICB9XG5dKTtcblxuYXBwLmZhY3RvcnkoJ0FwaUF1dGhlbnRpY2F0b3InLCBbXG4gICdTZXNzaW9uJyxcbiAgJ1NFUlZFUl9VUkwnLFxuICBmdW5jdGlvbihTZXNzaW9uLCBTRVJWRVJfVVJMKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICBpZiAoY29uZmlnLnVybC5pbmRleE9mKCdhcGkvJykgPT09IDAgfHwgY29uZmlnLnVybC5pbmRleE9mKCdhdXRoLycpID09PSAwKSB7XG4gICAgICAgICAgY29uZmlnLnVybCA9IFNFUlZFUl9VUkwuQkFTRV9VUkwgKyBjb25maWcudXJsO1xuICAgICAgICAgIGNvbmZpZy5oZWFkZXJzWydBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nXSA9IFNFUlZFUl9VUkwuQkFTRV9VUkw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRva2VuID0gU2Vzc2lvbi5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICBjb25maWcuaGVhZGVyc1sneC1hY2Nlc3MtdG9rZW4nXSA9IHRva2VuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnY2hlY2tpbicpXG4gIC5jb25maWcoW1xuICAgICckc3RhdGVQcm92aWRlcicsXG4gICAgJyR1cmxSb3V0ZXJQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oXG4gICAgICAkc3RhdGVQcm92aWRlcixcbiAgICAgICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvbG9naW4vbG9naW4uaHRtbFwiLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcicsXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuc3RhdGUoJ2NoZWNraW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvY2hlY2tpbicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2NoZWNraW4vY2hlY2tpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDaGVja2luQ29udHJvbGxlcicsXG4gICAgICAgICAgfSk7XG4gICAgfVxuICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjaGVja2luJylcbiAgLmZhY3RvcnkoJ0F1dGhTZXJ2aWNlJywgW1xuICAgICckcScsXG4gICAgJyRodHRwJyxcbiAgICAnJHJvb3RTY29wZScsXG4gICAgJyRzdGF0ZScsXG4gICAgJ1Nlc3Npb24nLFxuICAgIGZ1bmN0aW9uKCRxLCAkaHR0cCwgJHJvb3RTY29wZSwgJHN0YXRlLCBTZXNzaW9uKSB7XG4gICAgICB2YXIgYXV0aFNlcnZpY2UgPSB7fTtcbiAgICAgIHZhciBiYXNlVXJsID0gJ2F1dGgvJztcblxuICAgICAgZnVuY3Rpb24gbG9naW5TdWNjZXNzKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgY29uc29sZS5sb2coJ2F1dGggc3VjY2VzcycsIGRhdGEpO1xuICAgICAgICBTZXNzaW9uLmNyZWF0ZShkYXRhLnRva2VuLCBkYXRhLnVzZXIpO1xuICAgICAgICByZXR1cm4gJHEoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICAgIHJlc29sdmUoZGF0YS51c2VyKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGxvZ2luRmFpbHVyZShkYXRhLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zb2xlLmxvZygnYXV0aCBmYWlsJywgZGF0YSk7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIHJlamVjdChkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIH1cblxuICAgICAgYXV0aFNlcnZpY2UubG9naW5XaXRoUGFzc3dvcmQgPSBmdW5jdGlvbihlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICAgICAgcmV0dXJuICRodHRwXG4gICAgICAgICAgLnBvc3QoYmFzZVVybCArICdsb2dpbicsIHtcbiAgICAgICAgICAgIGVtYWlsOiBlbWFpbCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGxvZ2luU3VjY2VzcywgbG9naW5GYWlsdXJlKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIFRPRE8gdW5zdXJlIGlmIHRoaXMgd29ya3MhXG4gICAgICBhdXRoU2VydmljZS5sb2dpbldpdGhUb2tlbiA9IGZ1bmN0aW9uKHRva2VuKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIk5vdCBhY3R1YWxseSBzdXJlIGlmIHRoaXMgd29ya3MgeWV0IVwiKTtcbiAgICAgICAgcmV0dXJuICRodHRwXG4gICAgICAgICAgLnBvc3QoYmFzZVVybCArICdsb2dpbicsIHtcbiAgICAgICAgICAgIHRva2VuOiB0b2tlblxuICAgICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4obG9naW5TdWNjZXNzLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IDQwMCkge1xuICAgICAgICAgICAgICBTZXNzaW9uLmRlc3Ryb3koKS50aGVuKGxvZ2luRmFpbHVyZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gYXV0aFNlcnZpY2U7XG4gICAgfVxuICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjaGVja2luJylcbiAgLnNlcnZpY2UoJ1Nlc3Npb24nLCBbXG4gICAgJyRyb290U2NvcGUnLFxuICAgICckd2luZG93JyxcbiAgICAnJHEnLFxuICAgIGZ1bmN0aW9uKCRyb290U2NvcGUsICR3aW5kb3csICRxKXtcbiAgICAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24odG9rZW4sIHVzZXIpe1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3QgPSB0b2tlbjtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2UudXNlcklkID0gdXNlci5faWQ7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyID0gSlNPTi5zdHJpbmdpZnkodXNlcik7XG4gICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5kZXN0cm95ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dDtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLnVzZXJJZDtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyO1xuICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcbiAgICAgICAgcmV0dXJuICRxKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dDtcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuZ2V0VXNlcklkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLnVzZXJJZDtcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cubG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKTtcbiAgICAgIH07XG4gIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjaGVja2luJylcbiAgLmZhY3RvcnkoJ1VzZXJTZXJ2aWNlJywgW1xuICAgICckcScsXG4gICAgJyRodHRwJyxcbiAgICAnU2Vzc2lvbicsXG4gICAgZnVuY3Rpb24oJHEsICRodHRwLCBTZXNzaW9uKSB7XG4gICAgICB2YXIgdXNlcnMgPSAnYXBpL3VzZXJzJztcbiAgICAgIHZhciBiYXNlID0gdXNlcnMgKyAnLyc7XG5cbiAgICAgIHZhciBVc2VyU2VydmljZSA9IHt9O1xuXG4gICAgICBVc2VyU2VydmljZS5nZXRVc2VycyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHVybCA9IG9wdGlvbnMgPyB1c2VycyArICc/JyArICQucGFyYW0oXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGV4dDogb3B0aW9ucy50ZXh0LFxuICAgICAgICAgICAgcGFnZTogb3B0aW9ucy5wYWdlID8gb3B0aW9ucy5wYWdlIDogMCxcbiAgICAgICAgICAgIHNpemU6IG9wdGlvbnMuc2l6ZSA/IG9wdGlvbnMuc2l6ZSA6IDUwXG4gICAgICAgICAgfSkgOiBiYXNlO1xuXG4gICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsKTtcbiAgICAgIH07XG5cbiAgICAgIFVzZXJTZXJ2aWNlLmNoZWNraW4gPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoYmFzZSArIHVzZXJJZCArICcvY2hlY2tpbicpO1xuICAgICAgfTtcblxuICAgICAgVXNlclNlcnZpY2UuY2hlY2tvdXQgPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoYmFzZSArIHVzZXJJZCArICcvY2hlY2tvdXQnKTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBVc2VyU2VydmljZTtcbiAgICB9XG4gIF0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2NoZWNraW4nKVxuICAuY29udHJvbGxlcignQ2hlY2tpbkNvbnRyb2xsZXInLCBbXG4gICAgJyRzY29wZScsXG4gICAgJ1VzZXJTZXJ2aWNlJyxcbiAgICBmdW5jdGlvbigkc2NvcGUsIFVzZXJTZXJ2aWNlKSB7XG5cbiAgICAgICRzY29wZS51c2VycyA9IHtcbiAgICAgICAgdXNlcnM6IFtdLFxuICAgICAgICBidXN5OiBmYWxzZSxcbiAgICAgICAgbmV4dFBhZ2U6IDAsXG4gICAgICAgIHRvdGFsUGFnZXM6IEluZmluaXR5LFxuICAgICAgfTtcblxuICAgICAgJHNjb3BlLnVzZXJzLmdldE5leHRQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmJ1c3kpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmICh0aGlzLm5leHRQYWdlID49IHRoaXMudG90YWxQYWdlcykgeyByZXR1cm47IH1cblxuICAgICAgICB0aGlzLmJ1c3kgPSB0cnVlO1xuXG4gICAgICAgIFVzZXJTZXJ2aWNlLmdldFVzZXJzKHtcbiAgICAgICAgICBwYWdlOiB0aGlzLm5leHRQYWdlLFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7XG5cbiAgICAgICAgICB0aGlzLnVzZXJzID0gdGhpcy51c2Vycy5jb25jYXQocmVzcG9uc2UuZGF0YS51c2Vycyk7XG5cbiAgICAgICAgICB0aGlzLnRvdGFsUGFnZXMgPSByZXNwb25zZS5kYXRhLnRvdGFsUGFnZXM7XG4gICAgICAgICAgdGhpcy5uZXh0UGFnZSArPSAxO1xuICAgICAgICAgIHRoaXMuYnVzeSA9IGZhbHNlO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgfTtcblxuXG4gICAgICAkc2NvcGUuY2hlY2tpbiA9IGZ1bmN0aW9uKHVzZXJJZCkge1xuICAgICAgICBVc2VyU2VydmljZS5jaGVja2luKHVzZXJJZClcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2hlY2tlZCBpbicsIGRhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgJHNjb3BlLmNoZWNrb3V0ID0gZnVuY3Rpb24odXNlcklkKSB7XG4gICAgICAgIFVzZXJTZXJ2aWNlLmNoZWNrb3V0KHVzZXJJZClcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2hlY2tlZCBvdXQnLCBkYXRhKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfVxuICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdjaGVja2luJylcbiAgLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIFtcbiAgICAnJHNjb3BlJyxcbiAgICAnQXV0aFNlcnZpY2UnLFxuICAgIGZ1bmN0aW9uKCRzY29wZSwgQXV0aFNlcnZpY2UpIHtcblxuICAgICAgZnVuY3Rpb24gb25TdWNjZXNzKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3N1Y2Nlc3MnLCBkYXRhKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25GYWlsdXJlKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2ZhaWx1cmUnLCBkYXRhKTtcbiAgICAgIH1cblxuICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIEF1dGhTZXJ2aWNlLmxvZ2luV2l0aFBhc3N3b3JkKFxuICAgICAgICAgICRzY29wZS5lbWFpbCwgJHNjb3BlLnBhc3N3b3JkXG4gICAgICAgICkudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7XG4gICAgICB9O1xuICAgIH1cbiAgXSk7XG4iLCIvKipcbiAqIEhlcmUgbGF5IHRoZSBiYXNlIHVybHMgdXNlZCBpbiB0aGUgaHR0cCB1cmwgaW5qZWN0b3JcbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2NoZWNraW4nKS5jb25zdGFudCgnU0VSVkVSX1VSTCcsIHtcbiAgLy8gQkFTRV9VUkw6ICAnaHR0cHM6Ly9lMTJmOWIzZi5uZ3Jvay5pby8nLFxuICBCQVNFX1VSTDogICdodHRwczovL2FwcGx5LmhhY2tndC5jb20vJyxcblxufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
